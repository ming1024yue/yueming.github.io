const translations = {
    zh: {
        // Navigation
        'nav.home': '首页',
        'nav.thoughts': '想法',
        'nav.books': '阅读',
        'nav.products': '我的产品',
        
        // Home page
        'home.title': '岳铭',
        'home.bio': '致力于研究方法/工具，思维方式，让每个人都能够学会任何事情，创造属于自己的价值。',
        'home.profile.alt': '岳铭的照片',
        
        // Thoughts page
        'thoughts.title': '想法',
        'thoughts.all': '全部',
        
        // Books page
        'books.title': '阅读列表',
        'books.status.finished': '已读完',
        'books.status.reading': '正在读',
        'books.status.want': '想读',
        'books.hongloumeng.title': '红楼梦',
        'books.hongloumeng.author': 'by 曹雪芹',
        'books.hongloumeng.comment': '"身后有余忘缩手，眼前无路想回头。"',
        'books.walden.title': 'Walden',
        'books.walden.author': 'by Henry David Thoreau',
        'books.walden.comment': '"A man who has at length found something to do will not need to get a new suit to do it in. If there is not a new man, how can the new clothes be made to fit? All men want, not something to do with, but something to do, or rather something to be. Perhaps we should never procure a new suit until we have so conducted that we feel like new men in the old"',
        'books.zhongxian.title': '中县干部',
        'books.zhongxian.author': 'by 冯军旗',
        'books.zhongxian.comment': '"干部的权力是人民给的"',
        'books.essential_math.title': 'essential math for AI',
        'books.essential_math.author': 'by Hala Nelson',
        'books.essential_math.comment': '"关于AI的数学基础"',
        'books.deep_learning.title': 'Deep Learning',
        'books.deep_learning.author': 'by John.D.Kelleher',
        'books.deep_learning.comment': '"The book introduce deep learning concepts, which covers data, algorithms,models and their training."',
        'books.source_code.title': 'Source Code-My Beginnings',
        'books.source_code.author': 'by Bill Gates',
        'books.source_code.comment': '"The autobiography written by Microsoft founder Bill Gates."',
        
        // Products page
        'products.title': '我的产品',
        'products.deepfocus.title': 'Deep Focus 深度对焦',
        'products.deepfocus.description': '一款帮助你高效专注、提升生产力的极简 App。',
        'products.deepfocus.tags': 'App,效率',
        'products.deepfocus.learnmore': '了解更多',
        'products.deepfocus.cover.alt': 'Deep Focus封面',
        'products.deepfocus.description.detail': '专注是一种习惯和能力，你可以在这里训练它。',
        'products.deepfocus.feature1': '一次只能设立一个目标，且不能修改',
        'products.deepfocus.feature2': '格子化追踪你的进步',
        'products.deepfocus.feature3': '支持iOS17+, 已上线App store',
        'products.deepfocus.download': '前往 App Store 下载',
        'products.wordzen.title': 'WordZen 单词禅',
        'products.wordzen.description': '一款专注于学习单词的App，像修禅一样学习单词。',
        'products.wordzen.description.detail': '学习单词就像修禅一样，需要专注和坚持。WordZen帮助你以最纯粹的方式学习单词。',
        'products.wordzen.feature1': '每日只学习少量精选单词',
        'products.wordzen.feature2': '禅意界面设计，减少干扰',
        'products.wordzen.feature3': '支持iOS17+, 已上线App store',
        'products.wordzen.download': '前往 App Store 下载',
        'products.wordzen.cover.alt': 'WordZen封面',
        
        // Footer
        'footer.copyright': '© 2025 岳铭. All rights reserved.',
        
        // Support section
        'support.title': '如果你喜欢我的作品，欢迎自愿打赏一杯咖啡的钱（建议不超过 10 元）。小小支持，大大鼓励',
        'support.qr.alt': '支付宝支持二维码',
        'support.buycoffee.alt': 'Buy Me a Coffee',
        
        // Language switcher
        'lang.switch': '切换语言',
        'lang.zh': '中文',
        'lang.en': 'English'
    },
    
    en: {
        // Navigation
        'nav.home': 'Home',
        'nav.thoughts': 'Thoughts',
        'nav.books': 'Books',
        'nav.products': 'Products',
        
        // Home page
        'home.title': 'Yue Ming',
        'home.bio': 'Dedicated to researching methods/tools and ways of thinking, enabling everyone to learn anything and create their own value.',
        'home.profile.alt': 'Yue Ming\'s photo',
        
        // Thoughts page
        'thoughts.title': 'Thoughts',
        'thoughts.all': 'All',
        
        // Books page
        'books.title': 'Reading List',
        'books.status.finished': 'Finished',
        'books.status.reading': 'Reading',
        'books.status.want': 'Want to Read',
        'books.hongloumeng.title': 'Dream of the Red Chamber',
        'books.hongloumeng.author': 'by Cao Xueqin',
        'books.hongloumeng.comment': '"Behind there is plenty, yet forget to withdraw your hand; before there is no way, yet want to turn back."',
        'books.walden.title': 'Walden',
        'books.walden.author': 'by Henry David Thoreau',
        'books.walden.comment': '"A man who has at length found something to do will not need to get a new suit to do it in. If there is not a new man, how can the new clothes be made to fit? All men want, not something to do with, but something to do, or rather something to be. Perhaps we should never procure a new suit until we have so conducted that we feel like new men in the old"',
        'books.zhongxian.title': 'County Cadres',
        'books.zhongxian.author': 'by Feng Junqi',
        'books.zhongxian.comment': '"The power of cadres is given by the people"',
        'books.essential_math.title': 'Essential Math for AI',
        'books.essential_math.author': 'by Hala Nelson',
        'books.essential_math.comment': '"Mathematical foundations for AI"',
        'books.deep_learning.title': 'Deep Learning',
        'books.deep_learning.author': 'by John.D.Kelleher',
        'books.deep_learning.comment': '"The book introduces deep learning concepts, which covers data, algorithms, models and their training."',
        'books.source_code.title': 'Source Code-My Beginnings',
        'books.source_code.author': 'by Bill Gates',
        'books.source_code.comment': '"The autobiography written by Microsoft founder Bill Gates."',
        
        // Products page
        'products.title': 'My Products',
        'products.deepfocus.title': 'Deep Focus',
        'products.deepfocus.description': 'A minimalist app that helps you focus efficiently and boost productivity.',
        'products.deepfocus.tags': 'App,Productivity',
        'products.deepfocus.learnmore': 'Learn More',
        'products.deepfocus.cover.alt': 'Deep Focus cover',
        'products.deepfocus.description.detail': 'Focus is a habit and ability that you can train here.',
        'products.deepfocus.feature1': 'You can only set one goal at a time and cannot modify it',
        'products.deepfocus.feature2': 'Grid-based progress tracking',
        'products.deepfocus.feature3': 'Supports iOS17+, available on App Store',
        'products.deepfocus.download': 'Download on App Store',
        'products.wordzen.title': 'WordZen',
        'products.wordzen.description': 'A vocabulary learning app that focuses on learning words like practicing Zen meditation.',
        'products.wordzen.description.detail': 'Learning vocabulary is like practicing Zen - it requires focus and persistence. WordZen helps you learn words in the purest way.',
        'products.wordzen.feature1': 'Learn only a few carefully selected words each day',
        'products.wordzen.feature2': 'Zen-inspired interface design to reduce distractions',
        'products.wordzen.feature3': 'Supports iOS17+, available on App Store',
        'products.wordzen.download': 'Download on App Store',
        'products.wordzen.cover.alt': 'WordZen cover',
        
        // Footer
        'footer.copyright': '© 2025 Yue Ming. All rights reserved.',
        
        // Support section
        'support.title': 'If you like my work, feel free to buy me a coffee (suggested amount: no more than ¥10). Small support, big encouragement.',
        'support.qr.alt': 'Alipay support QR code',
        'support.buycoffee.alt': 'Buy Me a Coffee',
        
        // Language switcher
        'lang.switch': 'Switch Language',
        'lang.zh': '中文',
        'lang.en': 'English'
    }
};

// Language management functions
function getCurrentLanguage() {
    return localStorage.getItem('language') || 'zh';
}

function setLanguage(lang) {
    localStorage.setItem('language', lang);
    document.documentElement.lang = lang;
    updatePageContent();
    
    // Update language switcher active state
    const zhBtn = document.getElementById('lang-zh');
    const enBtn = document.getElementById('lang-en');
    if (zhBtn && enBtn) {
        zhBtn.classList.toggle('active', lang === 'zh');
        enBtn.classList.toggle('active', lang === 'en');
    }
}

function translate(key) {
    const currentLang = getCurrentLanguage();
    return translations[currentLang][key] || key;
}

function updatePageContent() {
    const currentLang = getCurrentLanguage();
    
    // Update navigation
    const navLinks = document.querySelectorAll('.menu-group a');
    navLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href === 'index.html') {
            link.textContent = translate('nav.home');
        } else if (href === 'thoughts.html') {
            link.textContent = translate('nav.thoughts');
        } else if (href === 'books.html') {
            link.textContent = translate('nav.books');
        } else if (href === 'products.html') {
            link.textContent = translate('nav.products');
        }
    });
    
    // Update page-specific content
    updatePageSpecificContent();
    
    // Update footer
    const footer = document.querySelector('footer p');
    if (footer) {
        footer.textContent = translate('footer.copyright');
    }
}

function updatePageSpecificContent() {
    const currentLang = getCurrentLanguage();
    const path = window.location.pathname;
    
    if (path.includes('index.html') || path === '/') {
        // Home page
        const title = document.querySelector('h1');
        if (title) title.textContent = translate('home.title');
        
        const bio = document.querySelector('.bio p');
        if (bio) bio.textContent = translate('home.bio');
        
        const profileImg = document.querySelector('.profile-image img');
        if (profileImg) profileImg.alt = translate('home.profile.alt');
        
    } else if (path.includes('thoughts.html')) {
        // Thoughts page
        const title = document.querySelector('#thoughts h2');
        if (title) title.textContent = translate('thoughts.title');
        
        // Update "All" tag
        const allTag = document.querySelector('.tag-filter[data-tag="all"]');
        if (allTag) allTag.textContent = translate('thoughts.all');
        
    } else if (path.includes('books.html')) {
        // Books page
        const title = document.querySelector('#books h2');
        if (title) title.textContent = translate('books.title');
        
        // Update elements with data-translate attribute
        const translatableElements = document.querySelectorAll('[data-translate]');
        translatableElements.forEach(element => {
            const key = element.getAttribute('data-translate');
            element.textContent = translate(key);
        });
        
        // Update book statuses
        const statusElements = document.querySelectorAll('.book-status');
        statusElements.forEach(status => {
            const statusClass = status.className;
            if (statusClass.includes('finished')) {
                status.textContent = translate('books.status.finished');
            } else if (statusClass.includes('reading')) {
                status.textContent = translate('books.status.reading');
            } else if (statusClass.includes('want')) {
                status.textContent = translate('books.status.want');
            }
        });
        
        // Update book titles and details
        const bookTitles = document.querySelectorAll('.book-title');
        const bookAuthors = document.querySelectorAll('.book-author');
        const bookComments = document.querySelectorAll('.book-comment');
        
        // Map book titles to translation keys
        const bookTitleMap = {
            '红楼梦': 'books.hongloumeng.title',
            'Dream of the Red Chamber': 'books.hongloumeng.title',
            'Walden': 'books.walden.title',
            '中县干部': 'books.zhongxian.title',
            'County Cadres': 'books.zhongxian.title',
            'essential math for AI': 'books.essential_math.title',
            'Essential Math for AI': 'books.essential_math.title',
            'Deep Learning': 'books.deep_learning.title',
            'Source Code-My Beginnings': 'books.source_code.title'
        };
        
        // Map book authors to translation keys
        const bookAuthorMap = {
            'by 曹雪芹': 'books.hongloumeng.author',
            'by Cao Xueqin': 'books.hongloumeng.author',
            'by Henry David Thoreau': 'books.walden.author',
            'by 冯军旗': 'books.zhongxian.author',
            'by Feng Junqi': 'books.zhongxian.author',
            'by Hala Nelson': 'books.essential_math.author',
            'by John.D.Kelleher': 'books.deep_learning.author',
            'by Bill Gates': 'books.source_code.author'
        };
        
        // Map book comments to translation keys
        const bookCommentMap = {
            '"身后有余忘缩手，眼前无路想回头。"': 'books.hongloumeng.comment',
            '"Behind there is plenty, yet forget to withdraw your hand; before there is no way, yet want to turn back."': 'books.hongloumeng.comment',
            '"A man who has at length found something to do will not need to get a new suit to do it in. If there is not a new man, how can the new clothes be made to fit? All men want, not something to do with, but something to do, or rather something to be. Perhaps we should never procure a new suit until we have so conducted that we feel like new men in the old"': 'books.walden.comment',
            '"干部的权力是人民给的"': 'books.zhongxian.comment',
            '"The power of cadres is given by the people"': 'books.zhongxian.comment',
            '"关于AI的数学基础"': 'books.essential_math.comment',
            '"Mathematical foundations for AI"': 'books.essential_math.comment',
            '"The book introduce deep learning concepts, which covers data, algorithms,models and their training."': 'books.deep_learning.comment',
            '"The book introduces deep learning concepts, which covers data, algorithms, models and their training."': 'books.deep_learning.comment',
            '"The autobiography written by Microsoft founder Bill Gates."': 'books.source_code.comment'
        };
        
        // Update book titles
        bookTitles.forEach(title => {
            const originalText = title.textContent.trim();
            const translationKey = bookTitleMap[originalText];
            if (translationKey) {
                title.textContent = translate(translationKey);
            }
        });
        
        // Update book authors
        bookAuthors.forEach(author => {
            const originalText = author.textContent.trim();
            const translationKey = bookAuthorMap[originalText];
            if (translationKey) {
                author.textContent = translate(translationKey);
            }
        });
        
        // Update book comments
        bookComments.forEach(comment => {
            const originalText = comment.textContent.trim();
            const translationKey = bookCommentMap[originalText];
            if (translationKey) {
                comment.textContent = translate(translationKey);
            }
        });
        
        // Update book cover alt texts
        const bookCovers = document.querySelectorAll('.cover-image');
        bookCovers.forEach(cover => {
            const altText = cover.alt;
            if (altText.includes('红楼梦')) {
                cover.alt = currentLang === 'zh' ? '红楼梦 book cover' : 'Dream of the Red Chamber book cover';
            } else if (altText.includes('Walden')) {
                cover.alt = currentLang === 'zh' ? 'Walden book cover' : 'Walden book cover';
            } else if (altText.includes('中县干部')) {
                cover.alt = currentLang === 'zh' ? '中县干部 book cover' : 'County Cadres book cover';
            } else if (altText.includes('Essential Math for AI')) {
                cover.alt = currentLang === 'zh' ? 'Essential Math for AI book cover' : 'Essential Math for AI book cover';
            } else if (altText.includes('Deep Learning')) {
                cover.alt = currentLang === 'zh' ? 'Deep Learning book cover' : 'Deep Learning book cover';
            } else if (altText.includes('Source code')) {
                cover.alt = currentLang === 'zh' ? 'Source code book cover' : 'Source Code book cover';
            }
        });
        
    } else if (path.includes('products.html')) {
        // Products page
        const title = document.querySelector('.products-showcase h2');
        if (title) title.textContent = translate('products.title');
        
        // Update elements with data-translate attribute
        const translatableElements = document.querySelectorAll('[data-translate]');
        translatableElements.forEach(element => {
            const key = element.getAttribute('data-translate');
            element.textContent = translate(key);
        });
        
        // Update Deep Focus product
        const deepFocusTitle = document.querySelector('.product-card h3');
        if (deepFocusTitle) deepFocusTitle.textContent = translate('products.deepfocus.title');
        
        const deepFocusDesc = document.querySelector('.product-card p');
        if (deepFocusDesc) deepFocusDesc.textContent = translate('products.deepfocus.description');
        
        const deepFocusLink = document.querySelector('.product-link');
        if (deepFocusLink) deepFocusLink.textContent = translate('products.deepfocus.learnmore');
        
        const deepFocusImg = document.querySelector('.product-card img');
        if (deepFocusImg) deepFocusImg.alt = translate('products.deepfocus.cover.alt');
        
        // Update WordZen product
        const wordZenTitle = document.querySelectorAll('.product-card h3')[1];
        if (wordZenTitle) wordZenTitle.textContent = translate('products.wordzen.title');
        
        const wordZenDesc = document.querySelectorAll('.product-card p')[1];
        if (wordZenDesc) wordZenDesc.textContent = translate('products.wordzen.description');
        
        const wordZenLink = document.querySelectorAll('.product-link')[1];
        if (wordZenLink) wordZenLink.textContent = translate('products.deepfocus.learnmore');
        
        const wordZenImg = document.querySelectorAll('.product-card img')[1];
        if (wordZenImg) wordZenImg.alt = translate('products.wordzen.cover.alt');
        
        // Update product tags
        const productTags = document.querySelectorAll('.product-tags .tag');
        productTags.forEach(tag => {
            const tagText = tag.textContent.trim();
            if (tagText === 'App') {
                tag.textContent = 'App'; // App stays the same in both languages
            } else if (tagText === '效率') {
                tag.textContent = currentLang === 'zh' ? '效率' : 'Productivity';
            } else if (tagText === 'Productivity') {
                tag.textContent = currentLang === 'zh' ? '效率' : 'Productivity';
            } else if (tagText === '学习') {
                tag.textContent = currentLang === 'zh' ? '学习' : 'Learning';
            } else if (tagText === 'Learning') {
                tag.textContent = currentLang === 'zh' ? '学习' : 'Learning';
            }
        });
        
        // Update support section
        const supportText = document.querySelector('.coffee-thank');
        if (supportText) supportText.textContent = translate('support.title');
        
        const qrImg = document.querySelector('.coffee-qr-card img');
        if (qrImg) qrImg.alt = translate('support.qr.alt');
        
        const buyCoffeeImg = document.querySelector('.coffee-btn-img');
        if (buyCoffeeImg) buyCoffeeImg.alt = translate('support.buycoffee.alt');
        
    } else if (path.includes('product-deep-focus.html')) {
        // Deep Focus product detail page
        const title = document.querySelector('.product-detail h2');
        if (title) title.textContent = translate('products.deepfocus.title');
        
        const description = document.querySelector('.product-detail p');
        if (description) description.textContent = translate('products.deepfocus.description.detail');
        
        const features = document.querySelectorAll('.product-detail ul li');
        if (features.length >= 3) {
            features[0].textContent = translate('products.deepfocus.feature1');
            features[1].textContent = translate('products.deepfocus.feature2');
            features[2].textContent = translate('products.deepfocus.feature3');
        }
        
        const downloadLink = document.querySelector('.product-link');
        if (downloadLink) downloadLink.textContent = translate('products.deepfocus.download');
        
        const productImg = document.querySelector('.product-detail img');
        if (productImg) productImg.alt = translate('products.deepfocus.cover.alt');
        
        // Update support section
        const supportText = document.querySelector('.coffee-thank');
        if (supportText) supportText.textContent = translate('support.title');
        
        const qrImg = document.querySelector('.coffee-qr-card img');
        if (qrImg) qrImg.alt = translate('support.qr.alt');
        
        const buyCoffeeImg = document.querySelector('.coffee-btn-img');
        if (buyCoffeeImg) buyCoffeeImg.alt = translate('support.buycoffee.alt');
        
    } else if (path.includes('product-wordzen.html')) {
        // WordZen product detail page
        const title = document.querySelector('.product-detail h2');
        if (title) title.textContent = translate('products.wordzen.title');
        
        const description = document.querySelector('.product-detail p');
        if (description) description.textContent = translate('products.wordzen.description.detail');
        
        const features = document.querySelectorAll('.product-detail ul li');
        if (features.length >= 3) {
            features[0].textContent = translate('products.wordzen.feature1');
            features[1].textContent = translate('products.wordzen.feature2');
            features[2].textContent = translate('products.wordzen.feature3');
        }
        
        const downloadLink = document.querySelector('.product-link');
        if (downloadLink) downloadLink.textContent = translate('products.wordzen.download');
        
        const productImg = document.querySelector('.product-detail img');
        if (productImg) productImg.alt = translate('products.wordzen.cover.alt');
        
        // Update support section
        const supportText = document.querySelector('.coffee-thank');
        if (supportText) supportText.textContent = translate('support.title');
        
        const qrImg = document.querySelector('.coffee-qr-card img');
        if (qrImg) qrImg.alt = translate('support.qr.alt');
        
        const buyCoffeeImg = document.querySelector('.coffee-btn-img');
        if (buyCoffeeImg) buyCoffeeImg.alt = translate('support.buycoffee.alt');
    }
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', () => {
    const savedLang = getCurrentLanguage();
    document.documentElement.lang = savedLang;
    updatePageContent();
    
    // Update language switcher active state on all pages
    const zhBtn = document.getElementById('lang-zh');
    const enBtn = document.getElementById('lang-en');
    if (zhBtn && enBtn) {
        zhBtn.classList.toggle('active', savedLang === 'zh');
        enBtn.classList.toggle('active', savedLang === 'en');
    }
}); 